\section{Постановка задачи}

В этой главе подробно описаны основные требования к системе, разрабатываемой в~рамках данной работы,
а так~же в~контексте конкретных задач рассмотрены основные понятия предметной области. 

В последующих разделах этой главы детализированы следующие основные задачи:

\begin{enumerate}
\item{
  Реализация модуля импорта данных.
}
\item{
  Реализация подсистемы, обеспечивающей удобный интерфейс для~поиска, просмотра и модификации импортированных данных.
}
\item{
  Реализация алгоритма расчета отчислений правообладателям. 
}
\item{
  Генерация статистических отчетов в соответствии с~пожеланиями пользователя.
}
\item{
  Реализация механизмов авторизации, позволяющих разграничивать права доступа пользователей к~различным частям системы.
}
\end{enumerate}

Кроме того со стороны заказчика были выдвинуты следующие нефункциональные требования к~системе:

\begin{enumerate}
\item{
  Система должна быть реализована в~виде веб-приложения.
}
\item{
  В~качестве хранилища данных должна быть использована СУБД Microsoft SQL Server.
}
\item{
  Должен быть продуман механизм первоначальной установки системы и обновления версий 
  с~учетом ограничения доступа со стороны исполнителей к~веб-серверу и серверу~БД.
}
\end{enumerate}

Для дальнейшего ознакомления с работой необходимо ознакомиться с некоторыми базовыми терминами предметной области.

\textbf{Live} \textit{(синонимы: TV, телевещание)} --- часть деятельности провайдера, связанная с вещанием
телеканалов в режиме реального времени.

\textbf{VOD} \textit{(синонимы: Video-on-Demand, статика)} --- часть деятельности провайдера, связанная 
с предоставлением доступа к статичному видео-контенту.

В системе \textbf{Live} и \textbf{VOD} должны быть представлены в виде двух различных разделов приложения,
так как процессы, протекающие в контексте этих частей, практически не пересекаются.

\textbf{Ассет} \textit{(синонимы: Asset, клип)} --- единица статичного контента, множество которых составляет
VOD-библиотеку провайдера.

\textbf{Правообладатель} \textit{(синонимы: Лицензиар)} --- организация, предоставляющая контент провайдеру

\textbf{Биллинг провайдера} --- система, в которой происходит учет информации об использовании абонентами услуг провайдера, их тарификация, 
выставление счетов абонентам, обработка платежей. Для проектируемой в рамках данной работы системы биллинг является основным источником
данных, используемых при построении отчетов.

\subsection{Импорт данных}
Бизнес-процессы, исполняемые IPTV-провайдеров, порождают большое количество разнородных данных, 
на~основе которых должны строиться статистические отчеты.

В соответствии с числом базовых бизнес-процессов, описанных во Введении, существует два
основных вида импортируемых данных:

\begin{enumerate}
\item{
Структура договоров с правообладателями, которая детально описывает размер 
отчислений правообладателям при разных параметрах.
}
\item{
Данные, связанные с предоставлениям услуг абонентам: размер выручки провайдера, количество подписчиков и заказов VOD. 
}
\end{enumerate}

В этом разделе детально описаны источники данных, структура этих данных и понятия предметной области,
связанные с этими данными.

\subsubsection{Справочники}
Справочники --- это сущности, непосредственно связанные с деятельностью провайдера, однако не играющие ключевой роли
в~оценке состояния бизнес-процессов. Предполагается, что данные из~справочников не подвержены регулярным изменениям,
и их наполнение нужно произвести лишь однажды при инициализации системы.

Ниже описаны основные типы справочников:
\paragraph{Организации}
Список юридических лиц с их основными реквизитами. 

\paragraph{Дерево Территорий}
\label{par:regions}
Большая часть сущностей, используемых при построении отчетов, имеет связь с~конкретными территориями,
в которых провайдер осуществляет свою деятельность. Множество территорий образует дерево 
с четырьмя уровнями, причём в каждый уровень включаются объекты, непосредственно подчинённые объектам предыдущего уровня:

\begin{itemize}
\item{
  \textit{Страна} --- на данный момент деятельность провайдера ведется только в РФ, но при проектировании
  стоит учитывать возможность выхода на рынки других стран.
}
\item{
  \textit{Регион} --- страны разделяются на множество регионов. В случае РФ регионы соотвествуют
  крупным единицам административно-территориального деления, таким как Сибирский Федеральный округ 
  или Южный федеральный округ.
}
\item{
  \textit{Филиал} --- территориальная единица областного или краевого масштаба, характеризуется наличием
  местного филиала провайдера.
}
\item{
  \textit{Город} --- лист дерева регионов, соответствует населенным пунктам, в которых ведется деятельность провайдера.
}
\end{itemize}

Далее в работе термин ``Регион'' будет использоваться, как синоним понятия ``Территория''.

\paragraph{Телеканалы}
Список телеканалов, вещание которых производится провайдером. Каждый из каналов характеризуется его именем
и уникальным идентификатором в биллинге провайдера.

\paragraph{Пакеты телеканалов}
Каждый абонент IPTV-провайдера при подключении выбирает один из пакетов телеканалов, на~который
он подписывается. В контексте справочников пакеты характеризуются их именем и уникальным идентификатором
в~биллинге провайдера.

\subsubsection{Договоры с правообладателями}

Договоры с правообладателями --- это сущности, описывающие условия предоставления контента провайдеру.
В целом структуры договоров по Live и VOD похожи, но каждый из этих видов обладает своей спецификой.

\paragraph{Договоры по Live}
Основные характеристики договоров этого типа:

\begin{itemize}
\item{
  \textit{Правообладатель} - организация, с которой заключен договор.
}
\item{
  \textit{Юр. лицо} -  организация со стороны провайдера, на имя которой заключен договор.
}
\item{
  \textit{Номер договора} ---  уникальный идентификатор со сквозной нумерацией.
}
\item{
  \textit{Даты} --- дата заключения договора и его длительность.
}
\item{
  \textit{Территории} --- множество вершин дерева территорий, для которого актуален договор.
}
\end{itemize}

Каждый из договоров по Live содержит в себе \textit{пакеты телеканалов} (один и более), права на вещание которых обеспечивает договор.
Для каждого из пакетов должны быть описаны градации отчислений (не менее одной в пакете), устанавливающие условия и размер
отчислений правообладателю.

На момент проектирования системы договоры по Live у провайдера хранились в виде файла формата Microsoft Excel 2007, в~связи с~чем
необходимо было реализовать модуль для регулярного импорта договоров из этого файла со всеми связанными с ними сущностями.

\paragraph{Договоры по VOD} в целом изоморфны договорам первого типа, за исключением того, что условия договоров распространяются на множества ``ассетов''
вместо пакетов телеканалов.

\subsection{Статистические данные по Live}
Существует несколько видов статистических данных, связанных с Live, которые система должна регулярно импортировать
с помощью веб-сервисов биллинга.

\textbf{Количество подписчиков пакетов} --- множество кортежей, каждый из которых содержит информацию о количестве подписчиков
определенного пакета телеканалов для конкретной даты в одном из листьев дерева регионов (см. \ref{par:regions}).

\textbf{Доступность телеканала} --- множество кортежей, каждый из которых содержит информацию о доступности телеканала в
определенном пакете для конкретной даты в одном из листьев дерева регионов.

Информация о количестве подписчиков определенного телеканала в пакете не может быть получена из биллинга по той причине, что этой информации там нет, 
так как при подключении абоненты выбирают именно пакеты каналов. Но при этом можно вычислить усредненное значение этой величины 
в~рамках определенной даты, территории, пакета и телеканала по формуле:
$$Subscribers_{channel} = \frac{Subsribers_{package}} {Channels_{package}}, $$
где $Subscribers_{channel}$ --- искомая величина,  $Subsribers_{package}$ --- количество подписчиков пакета, 
а $Channels_{package}$ --- количество доступных в пакете каналов.

Еще одной важной импортируемой из биллинга величиной является \textbf{Выручка} --- множество кортежей, каждый из которых содержит информацию о
суммарной абонетской плате, полученной по определенному пакету телеканалов для конкретной даты в одном из листьев дерева регионов.
 
Веб-сервисы биллинга предоставляют вышеописанные данные в формате XML со строго заданной схемой. Система должна ежедневно импортировать эти данные,
сохраняя записи за последние пять лет.


